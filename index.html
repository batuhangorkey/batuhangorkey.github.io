<html>
<style>
    html,
    body {
        height: 100%;
        margin: 0;
        padding: 0px;
        overflow: hidden;
        background-color: black;
    }

    #canvas {
        width: 100%;
        height: 100%;
        background: #111;
    }
</style>

<body>
    <canvas id="conway"></canvas>
</body>
<script type="text/javascript">
    var canvas = document.getElementById("conway");
    canvas.addEventListener('wheel', (e) => zoom(e));
    var ctx = canvas.getContext("2d");
    var width = window.innerWidth;
    var height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;
    var cellSize = 2;
    var boardX = parseInt(width / cellSize);
    var boardY = parseInt(height / cellSize);
    var board = initialize_board();
    var factor = 1.0;
    var scaleFactor = 1.1;
    var zoomCounter = 0;
    ctx.fillStyle = "#000000";
    ctx.fillRect(0, 0, width, height);
    update();

    function zoom(event) {
        event.preventDefault();
        factor = Math.pow(scaleFactor, event.deltaY * 0.005);
        ctx.translate(width / 2, height / 2);
        ctx.scale(factor, factor);
        ctx.translate(-width / 2, -height / 2);
        zoomCounter++;
    }

    function update() {
        evaluate_board(board);
        draw_board(board);
        requestAnimationFrame(update);
    }

    function activation(x) {
        if (x == 3. || x == 11. || x == 12.) {
            return 1.;
        }
        return 0.;
    }

    function restart() {
        board = initialize_board();
    }

    function initialize_board() {
        var board = new Array(boardX * boardY);
        for (let i = 0; i < board.length; i++) {
            board[i] = getRandomInt(0, 2);
        }
        return board
    }

    function evaluate_board(board) {
        var temp = board.slice();
        for (let i = 0; i < board.length; i++) {
            const e = board[i];
            var rightWrap = (i + 1) % boardX != 0 ? 1 : 1 - boardX;
            var leftWrap = (i % boardX) != 0 ? -1 : boardX - 1;
            var up = (i > boardX) ? i - boardX : i + (boardX * (boardY - 1));
            var right = i + rightWrap;
            var down = (i + boardX) < (board.length) ? i + boardX : i % boardX;
            var left = i + leftWrap;
            var upRight = up + rightWrap;
            var upLeft = up + leftWrap;
            var downRight = down + rightWrap;
            var downLeft = down + leftWrap;
            var liveNeighbors = temp[up] + temp[right] + temp[down] + temp[left] +
                temp[upRight] + temp[upLeft] + temp[downRight] + temp[downLeft];
            if (liveNeighbors > 3 && e == 1) {
                board[i] = 0;
            } else if (liveNeighbors < 2 && e == 1) {
                board[i] = 0;
            } else if (liveNeighbors == 3 && e == 0) {
                board[i] = 1;
            }
        }
    }

    function draw_board(board) {
        ctx.translate(0, 0);
        // ctx.scale(cameraZoom, cameraZoom);
        // ctx.translate(-window.innerWidth / 2 + cameraOffset.x, -window;.innerHeight / 2 + cameraOffset.y)
        // ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
        ctx.save();
        ctx.setTransform(1, 0, 0, 1, 0, 0);
        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.fillRect(0, 0, width, height);
        ctx.restore();
        for (var i = 0; i < board.length; i++) {
            const x = i % boardX * cellSize;
            const y = Math.floor(i / boardX) * cellSize;
            if (board[i] == 1) {
                ctx.fillStyle = "rgba(255, 255, 255, 1)";
                ctx.fillRect(x, y, cellSize, cellSize);
            } else {

            }
        }
    }

    function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min)) + min;
    }

</script>

</html>